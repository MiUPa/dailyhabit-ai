# DailyHabit AI - ローカル完結版技術仕様書

## アーキテクチャ概要
スマートフォン内で完結する習慣トラッキングアプリ。外部サーバーやAPIに依存せず、オフラインでも全機能が利用可能。

## 技術スタック詳細

### フロントエンド
- **フレームワーク**: Flutter 3.16+
- **言語**: Dart
- **対応プラットフォーム**: iOS 12.0+, Android 6.0+
- **UIライブラリ**: Material Design 3 / Cupertino

### データ管理
- **データベース**: SQLite (sqflite)
- **データ永続化**: ローカルファイルシステム
- **バックアップ**: ローカルエクスポート/インポート機能

### AI機能（オンデバイス）
- **機械学習**: TensorFlow Lite
- **モデル**: 軽量な習慣予測モデル
- **処理**: デバイス内でのリアルタイム分析
- **モデルサイズ**: 5MB以下（アプリサイズ考慮）

### 通知・リマインダー
- **ローカル通知**: flutter_local_notifications
- **スケジューリング**: デバイス内での時間管理
- **カスタマイズ**: ユーザー設定可能な通知タイミング

## データ構造

### 習慣データ
```sql
CREATE TABLE habits (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    description TEXT,
    category TEXT,
    frequency TEXT, -- daily, weekly, monthly
    target_count INTEGER DEFAULT 1,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_active BOOLEAN DEFAULT 1
);
```

### 記録データ
```sql
CREATE TABLE habit_logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    habit_id INTEGER,
    completed_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    notes TEXT,
    mood INTEGER, -- 1-5 scale
    FOREIGN KEY (habit_id) REFERENCES habits (id)
);
```

### ユーザー設定
```sql
CREATE TABLE user_settings (
    id INTEGER PRIMARY KEY,
    theme TEXT DEFAULT 'light',
    notification_enabled BOOLEAN DEFAULT 1,
    reminder_time TEXT DEFAULT '09:00',
    language TEXT DEFAULT 'ja',
    premium_features BOOLEAN DEFAULT 0
);
```

## 主要機能詳細

### 1. 習慣管理
- **作成・編集**: 習慣の追加、修正、削除
- **カテゴリ分類**: 健康、学習、仕事、趣味など
- **頻度設定**: 毎日、週N回、月N回
- **目標設定**: 達成回数、継続日数

### 2. 記録・トラッキング
- **簡単記録**: ワンタップで完了記録
- **詳細記録**: メモ、気分、時間
- **カレンダー表示**: 月間・週間ビュー
- **統計分析**: 継続率、達成率、傾向分析

### 3. ローカルAI分析
- **継続予測**: 過去データに基づく継続可能性
- **パターン分析**: 成功しやすい時間帯、曜日
- **アドバイス生成**: 継続のコツ、改善提案
- **モチベーション分析**: 気分と継続率の相関

### 4. ゲーミフィケーション
- **レベルシステム**: 継続日数に応じたレベルアップ
- **バッジ**: 達成目標に応じたバッジ獲得
- **ストリーク**: 連続達成日数の記録
- **統計**: 総達成回数、最長ストリーク

### 5. 進捗可視化
- **グラフ表示**: 継続率、達成率の推移
- **カレンダービュー**: 日別の達成状況
- **統計レポート**: 週間・月間サマリー
- **エクスポート**: CSV形式でのデータ出力

## パフォーマンス要件

### アプリサイズ
- **基本アプリ**: 50MB以下
- **AIモデル**: 5MB以下
- **総サイズ**: 60MB以下

### 起動時間
- **コールドスタート**: 3秒以内
- **ウォームスタート**: 1秒以内

### メモリ使用量
- **通常時**: 100MB以下
- **AI処理時**: 150MB以下

## セキュリティ・プライバシー

### データ保護
- **ローカル保存**: 外部送信なし
- **暗号化**: SQLiteデータベースの暗号化
- **バックアップ**: ユーザー管理によるエクスポート

### プライバシー
- **データ収集**: 一切なし
- **外部通信**: 広告表示のみ
- **ユーザー同意**: 不要（ローカル完結）

## 収益化戦略

### フリーミアムモデル
- **無料版**:
  - 基本習慣管理（最大5個）
  - 基本統計表示
  - ローカル通知

- **プレミアム版**（月490円）:
  - 無制限習慣管理
  - 詳細AI分析
  - 高度な統計・グラフ
  - データエクスポート
  - カスタムテーマ

### 広告収入
- **バナー広告**: 無料版の下部に表示
- **インタースティシャル**: アプリ起動時（低頻度）
- **広告ネットワーク**: AdMob

## 開発フェーズ

### フェーズ1: MVP開発（4週間）
- 基本習慣管理機能
- SQLiteデータベース
- 簡単な統計表示

### フェーズ2: AI機能実装（3週間）
- TensorFlow Lite統合
- 基本的な予測機能
- パターン分析

### フェーズ3: ゲーミフィケーション（2週間）
- レベル・バッジシステム
- ストリーク機能
- 進捗可視化

### フェーズ4: 収益化・リリース（2週間）
- アプリ内課金実装
- 広告統合
- ストア申請・リリース

## 技術的制約と対策

### 制約事項
- **オフライン限定**: 外部API使用不可
- **デバイス性能**: 低スペック端末対応
- **ストレージ**: 限られた容量での動作

### 対策
- **軽量AIモデル**: 5MB以下の最適化済みモデル
- **効率的DB設計**: インデックス最適化
- **画像圧縮**: アセットの最適化
- **遅延読み込み**: 必要な時のみデータ読み込み 